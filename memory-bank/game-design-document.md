# 圣诞树手势互动网页游戏｜Game Design Document（GDD）

> 文件：`game-design-document.md`  
> 形式：浏览器端互动“玩具式”体验（Toy-like Experience），以**摄像头手势**驱动“圣诞树 ⇄ 媒体旋风展台”的形态变换。

---

## 1. 一句话概念（High Concept）
打开网页 → 授权摄像头 → 识别手部动作 → 一棵精美圣诞树在你手势“扇动/捏合/旋转”的指挥下**分解展开**为你上传的照片/GIF/视频组成的**龙卷风走马灯**；收拢则回到圣诞树。

---

## 2. 体验目标（Design Goals）
- **魔术感**：手一挥，树“啪”地展开成你的记忆墙；再一收，回归圣诞树。
- **低门槛**：无账号、无复杂规则；30 秒内懂怎么玩。
- **高审美**：树本体足够漂亮；展开后的媒体排列有节奏、有层次。
- **强可分享**：一键录屏/导出短视频（可选），适合社交平台。

---

## 3. 平台与受众（Platform & Audience）
- 平台：现代浏览器（Chrome / Edge / Safari iOS/macOS 建议可用）
- 设备：优先桌面端/笔记本（摄像头更稳定）；移动端为加分项
- 受众：想玩点“仪式感 + 互动炫技”的普通用户；也适合展会/课堂演示

---

## 4. 核心玩法循环（Core Loop）
1. 用户进入页面 → 看到默认圣诞树（Idle：轻微呼吸、彩灯闪烁）
2. 授权摄像头 → 显示简洁的手势提示（Overlay）
3. 用户手势输入 → 树开始**展开/旋转/收缩**
4. 展开状态中：用户上传媒体的走马灯/龙卷风围绕旋转，可暂停、快进、切换素材
5. 结束：用户收拢回树 → 截图/录制/分享（可选）

---

## 5. 交互与手势映射（Controls & Gestures）
> 手势识别以“稳定、少误触”为优先，宁可少也要准。下列为建议映射，可在可用性测试后微调。

### 5.1 基础手势
- **捏合（Pinch：拇指 + 食指靠近）**
  - 捏合强度（距离） → 控制“展开进度”  
  - 逻辑：捏合越紧 = 越收拢；越松开 = 越展开
- **水平扇动（Hand Swipe Left/Right）**
  - 控制整体旋转方向与角速度（圣诞树与媒体旋风同步）
- **手掌张开（Open Palm）**
  - “稳定模式/暂停旋转”：进入展示静止，便于看清图片
- **双手（可选增强）**
  - 两手距离变化：缩放龙卷风半径 / 媒体层数密度

### 5.2 手势容错与防抖
- 需要 200–400ms 的稳定窗口确认手势（避免抖动误触）
- 扇动使用速度阈值 + 冷却时间（cooldown）防止连续乱触发
- 识别失败时维持上一状态，并提示“把手移到框内”

---

## 6. 世界与视觉系统（Art & VFX）
### 6.1 圣诞树形态（Tree Mode）
- 结构层：树干、松针层（分层片/粒子）、彩灯（点光源）、彩球（反射材质）、彩带（曲线带状）
- 动效：呼吸式轻摆、灯光闪烁、微粒飘雪（可选）
- 质感：偏“精致、轻写实 + 童话光晕”的风格（避免过度拟真导致性能压力）

### 6.2 展开形态（Carousel Tornado Mode）
- 核心：媒体卡片沿螺旋轨迹排布，绕中心轴旋转（像龙卷风 + 走马灯）
- 深度层次：近景少量大卡片、远景更多小卡片，形成空间感
- 过渡：树元素“解体”变成粒子/几何碎片，重组为媒体框架

### 6.3 转场（Transformation）
- Tree → Tornado：树上彩球/灯点“飞出”形成螺旋轨迹；松针化为粒子雾；彩带拉伸成轨迹线
- Tornado → Tree：媒体卡片逐渐变小、变亮、变成彩灯点回归树体

---

## 7. 媒体内容（User Content）
### 7.1 支持格式
- 图片：JPG/PNG/WebP
- 动图：GIF
- 视频：MP4/WebM（建议限制单个文件大小，比如 30–80MB）
- 多文件：支持批量上传；可拖拽排序

### 7.2 内容呈现规则
- 优先保持比例（contain），避免裁切
- 自动生成“节奏”：每 N 张作为一圈；视频可设定最长播放片段（例如 3–5 秒循环）
- 若无上传内容：使用内置节日素材占位（默认包）

---

## 8. UI/UX（界面与流程）
### 8.1 主界面
- 中央：树/旋风主体 3D 画面
- 右下角：摄像头状态（已授权/未授权）、手势识别置信度指示
- 左下角：上传按钮、素材列表（缩略图）
- 顶部：模式提示（Tree / Tornado）、简短手势说明（可折叠）

### 8.2 新手引导
- 进入后 3 步引导：
  1) “允许摄像头”
  2) “把手放进框里”
  3) “捏合=收拢/松开=展开，挥手=旋转”

### 8.3 隐私提示
- 明确说明：**视频流仅在本地处理**；不上传服务器（除非用户主动分享/录制上传）

---

## 9. 技术方案（Tech Stack & Architecture）
### 9.1 推荐技术栈
- 摄像头：WebRTC `getUserMedia`
- 手势识别：MediaPipe Hands / TensorFlow.js 手部关键点模型（本地推理）
- 渲染：Three.js（WebGL）或 WebGPU（高级可选）
- 动画：GSAP / Three.js Tween
- 后处理：Bloom/DOF（可选，注意性能）
- 录制导出（可选）：`MediaRecorder` 录屏 + 简易导出

### 9.2 模块划分
- `Input`: 摄像头、手部关键点、手势状态机（防抖、阈值、冷却）
- `Scene`: 圣诞树模型、媒体卡片系统、粒子系统、灯光
- `State`: `TREE` / `TRANSFORMING` / `TORNADO` / `PAUSED`
- `UI`: 上传、素材管理、引导、隐私提示
- `Performance`: 帧率监控、降级策略（关闭部分后处理/减少粒子）

---

## 10. 状态机（Gameplay States）
- `TREE_IDLE`：树默认展示
- `TREE_ROTATE`：手势驱动旋转
- `TRANSFORM_OUT`：展开转场（树 → 媒体旋风）
- `TORNADO_ACTIVE`：媒体旋风展示 + 旋转
- `TRANSFORM_IN`：收拢转场（媒体旋风 → 树）
- `PAUSE_VIEW`：静止观看（张开手掌触发）

---

## 11. 关键参数（Tunable Parameters）
- 展开进度 `openProgress`：0（树）→ 1（旋风）
- 旋转速度 `spinVelocity`：由扇动速度映射，带衰减
- 旋风半径 `radius`：随 `openProgress` 增大
- 螺距 `pitch`：决定“龙卷风”高度与密度
- 卡片数量上限 `maxCards`：默认 30–80（依设备自动调整）
- 置信度阈值 `handConfidenceMin`：低于则冻结输入

---

## 12. 性能与兼容（Performance & Compatibility）
- 目标：桌面端 60fps；移动端 30fps 可接受
- 降级策略：
  - 低端设备：减少粒子、关 Bloom、降低分辨率（渲染到低倍率再放大）
  - 媒体过多：限制同时可见数量，其余延迟加载
- 兼容性注意：
  - iOS Safari 对自动播放视频限制：视频需静音并在用户交互后播放
  - 摄像头权限流程差异：需友好提示与回退

---

## 13. 风险与对策（Risks & Mitigations）
- **手势误识别/抖动** → 状态机 + 防抖窗口 + 冷却时间
- **光线影响识别** → 提示用户开灯/面对光源；显示置信度
- **素材过大导致卡顿** → 上传时压缩/转码（可选），或限制大小与数量
- **隐私担忧** → 明确“本地处理”，并提供“无摄像头模式”（鼠标/触控替代）

---

## 14. 里程碑（Milestones）
- M1（可玩原型）：摄像头 + 手部关键点 + 基础手势 → 控制旋转/展开数值
- M2（视觉原型）：圣诞树基础模型 + 展开为简单卡片螺旋
- M3（完整转场）：树元素解体/重组、光效、粒子
- M4（媒体系统）：上传管理、多格式支持、视频循环、数量控制
- M5（打磨发布）：性能优化、引导与隐私文案、录制导出（可选）

---

## 15. 验收标准（Acceptance Criteria）
- 用户能在 30 秒内完成：授权摄像头 → 展开/收拢 → 旋转
- 展开/收拢过渡连续、无明显跳变（曲线平滑）
- 上传 30 张图片仍保持流畅（桌面端目标 50–60fps）
- 隐私说明清晰，用户能选择禁用摄像头仍可体验（可选）

---

## 16. 备选输入（Fallback Controls）
- 鼠标拖拽：旋转
- 鼠标滚轮/触控缩放：展开/收拢
- 空格键：暂停/继续

---

## 17. 未来扩展（Stretch Goals）
- “装饰模式”：用户抓取某个彩球放到树上（手势拖拽）
- “节拍模式”：音乐节拍驱动灯光与旋转（Web Audio）
- 多主题：新年灯塔、烟花螺旋、星云相册等皮肤

---
